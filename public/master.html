<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Church Tap - Master Portal</title>
  <link href="/css/style.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="h-full overflow-x-hidden">
  
  <!-- Master Login Screen -->
  <div id="masterLoginScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900">
    <div class="max-w-md w-full space-y-8 px-4">
      <div class="text-center">
        <div class="mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white text-2xl shadow-lg">
          üöÄ
        </div>
        <h2 class="mt-6 text-center text-3xl font-extrabold text-white">Master Portal</h2>
        <p class="mt-2 text-center text-sm text-gray-300">Manage Church Tap organizations</p>
      </div>
      <div class="modern-card p-8">
        <form id="masterLoginForm" class="space-y-6">
          <div>
            <label for="masterUsername" class="block text-sm font-medium text-gray-700">Username</label>
            <input id="masterUsername" name="username" type="text" required 
                   class="mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                   placeholder="Enter username">
          </div>
          <div>
            <label for="masterPassword" class="block text-sm font-medium text-gray-700">Password</label>
            <input id="masterPassword" name="password" type="password" required 
                   class="mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                   placeholder="Enter password">
          </div>
          <div>
            <button type="submit" class="w-full btn-primary-modern">
              üîë Sign In to Master Portal
            </button>
          </div>
          <div id="masterLoginError" class="hidden text-red-600 text-sm text-center bg-red-50 p-3 rounded-lg"></div>
        </form>
      </div>
    </div>
  </div>

  <!-- Master Portal Dashboard -->
  <div id="masterDashboard" class="hidden">
    <div class="flex h-screen" style="background: radial-gradient(1200px 600px at 30% -10%, var(--brand-bg), color-mix(in srgb, var(--brand-primary) 10%, white))">
      
      <!-- Master Sidebar (Hidden on mobile) -->
      <div class="hidden lg:flex lg:flex-shrink-0">
        <div class="flex flex-col w-80">
          <!-- Sidebar Header -->
          <div class="flex items-center h-16 flex-shrink-0 px-6 sidebar-header border-b">
            <div class="flex items-center">
              <span class="text-2xl mr-3">üöÄ</span>
              <div>
                <div class="text-lg font-semibold">Master Portal</div>
                <div class="text-sm text-white/80">Church Tap SaaS</div>
              </div>
            </div>
          </div>
          
          <!-- Sidebar Navigation -->
          <div class="flex flex-col flex-1 overflow-y-auto admin-sidebar">
            <nav class="flex-1 px-4 py-6 space-y-2">
              <a href="#" id="dashboardMasterNav" class="nav-item active group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                <span class="mr-3 text-lg">üìä</span>
                Dashboard
              </a>
              
              <a href="#" id="organizationsMasterNav" class="nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                <span class="mr-3 text-lg">üè¢</span>
                Organizations
              </a>

              <a href="#" id="orgRequestsMasterNav" class="nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                <span class="mr-3 text-lg">üìã</span>
                Organization Requests
                <span id="pendingRequestsBadge" class="hidden ml-auto bg-red-500 text-white text-xs rounded-full px-2 py-1"></span>
              </a>

              <a href="#" id="billingMasterNav" class="nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                <span class="mr-3 text-lg">üí≥</span>
                Billing & Plans
              </a>
              
              <a href="#" id="analyticsMasterNav" class="nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                <span class="mr-3 text-lg">üìà</span>
                Global Analytics
              </a>
              
              <a href="#" id="tagActivitiesMasterNav" class="nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                <span class="mr-3 text-lg">üéØ</span>
                Tag Activities
              </a>
              
              <a href="#" id="supportMasterNav" class="nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                <span class="mr-3 text-lg">üéß</span>
                Support
              </a>
              
              <a href="#" id="systemMasterNav" class="nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                <span class="mr-3 text-lg">‚öôÔ∏è</span>
                System Settings
              </a>
            </nav>
            
            <!-- Sidebar Footer -->
            <div class="flex-shrink-0 sidebar-footer border-t p-4">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <div class="h-8 w-8 rounded-full avatar-brand flex items-center justify-center text-white text-sm font-medium">M</div>
            </div>
            <div class="ml-3 min-w-0 flex-1">
              <div class="text-sm font-medium text-white" id="masterAdminUsername"></div>
              <div class="text-xs text-white/80">Master Admin</div>
            </div>
            <button id="masterLogoutBtn" class="ml-3 p-1 rounded-full text-white/70 hover:text-white">
                  <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile Menu Overlay -->
      <div class="lg:hidden fixed inset-0 z-40 hidden" id="masterMobileMenuOverlay">
        <div class="fixed inset-0 bg-gray-600 bg-opacity-75" id="masterMobileMenuBackdrop"></div>
        <div class="relative flex-1 flex flex-col max-w-xs w-full">
          <div class="flex flex-col h-full admin-sidebar">
            <!-- Mobile Sidebar Header -->
            <div class="flex items-center justify-between h-16 flex-shrink-0 px-6 sidebar-header">
              <div class="flex items-center">
                <span class="text-2xl mr-3">üöÄ</span>
                <div>
                  <div class="text-lg font-semibold">Master Portal</div>
                  <div class="text-sm text-white/80">SaaS</div>
                </div>
              </div>
              <button id="closeMasterMobileMenu" class="p-2 rounded-md text-white/70 hover:text-white">
                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
              </button>
            </div>
            
            <!-- Mobile Navigation -->
            <nav class="flex-1 px-4 py-6 space-y-2 overflow-y-auto">
              <a href="#" class="master-mobile-nav-item group flex items-center px-3 py-3 text-sm font-medium rounded-lg" data-target="dashboardMasterContent">
                <span class="mr-3 text-lg">üìä</span>
                Dashboard
              </a>
              
              <a href="#" class="master-mobile-nav-item group flex items-center px-3 py-3 text-sm font-medium rounded-lg" data-target="organizationsMasterContent">
                <span class="mr-3 text-lg">üè¢</span>
                Organizations
              </a>
              
              <a href="#" class="master-mobile-nav-item group flex items-center px-3 py-3 text-sm font-medium rounded-lg" data-target="billingMasterContent">
                <span class="mr-3 text-lg">üí≥</span>
                Billing
              </a>
              
              <a href="#" class="master-mobile-nav-item group flex items-center px-3 py-3 text-sm font-medium rounded-lg" data-target="analyticsMasterContent">
                <span class="mr-3 text-lg">üìà</span>
                Analytics
              </a>
              
              <a href="#" class="master-mobile-nav-item group flex items-center px-3 py-3 text-sm font-medium rounded-lg" data-target="tagActivitiesMasterContent">
                <span class="mr-3 text-lg">üéØ</span>
                Tag Activities
              </a>
              
              <a href="#" class="master-mobile-nav-item group flex items-center px-3 py-3 text-sm font-medium rounded-lg" data-target="supportMasterContent">
                <span class="mr-3 text-lg">üéß</span>
                Support
              </a>
              
              <a href="#" class="master-mobile-nav-item group flex items-center px-3 py-3 text-sm font-medium rounded-lg" data-target="systemMasterContent">
                <span class="mr-3 text-lg">‚öôÔ∏è</span>
                System
              </a>
            </nav>
            
            <!-- Mobile Sidebar Footer -->
            <div class="flex-shrink-0 sidebar-footer border-t p-4">
              <div class="flex items-center">
                <div class="flex-shrink-0">
                  <div class="h-8 w-8 rounded-full avatar-brand flex items-center justify-center text-white text-sm font-medium" id="masterMobileAdminAvatar">M</div>
                </div>
                <div class="ml-3 min-w-0 flex-1">
                  <div class="text-sm font-medium text-white" id="masterMobileAdminUsername"></div>
                  <div class="text-xs text-white/80">Master Admin</div>
                </div>
                <button id="masterMobileLogoutBtn" class="ml-3 p-1 rounded-full text-white/70 hover:text-white">
                  <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content Area -->
      <div class="flex-1 flex flex-col overflow-hidden">
        <!-- Top Header -->
        <header class="w-full admin-header-divider">
          <div class="relative z-10 flex-shrink-0 h-16 admin-header flex">
            <!-- Mobile menu button -->
            <button class="lg:hidden px-4 border-r border-gray-200 text-gray-400 focus:outline-none focus:text-gray-600" id="masterMobileMenuBtn">
              <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
            </button>
            
            <div class="flex-1 flex justify-between px-4 sm:px-6 lg:px-8">
              <div class="flex-1 flex items-center">
                <h1 class="text-3xl font-bold text-white" id="masterPageTitle">Dashboard</h1>
              </div>
              <div class="flex items-center space-x-4">
                <button id="menuThemeToggle" class="hidden md:inline-flex px-3 py-1 rounded-md text-sm bg-white/10 hover:bg-white/20 text-white">Toggle Menu Text</button>
              </div>
            </div>
          </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 relative overflow-y-auto focus:outline-none">
          <div class="py-6 px-4 sm:px-6 lg:px-8">
      
            <!-- Master Dashboard Tab -->
            <div id="dashboardMasterContent" class="tab-content">
              
              <!-- Key Metrics -->
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üè¢</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Total Organizations</dt>
                        <dd id="totalOrganizations" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">‚úÖ</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Active Organizations</dt>
                        <dd id="activeOrganizations" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üí∞</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Monthly Revenue</dt>
                        <dd id="monthlyRevenue" class="text-2xl font-bold text-gray-900">$--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üë•</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Total Users</dt>
                        <dd id="totalUsers" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Global 7-Day Activity -->
              <div class="modern-card p-6 mb-8">
                <div class="flex items-center justify-between mb-4">
                  <h3 class="text-lg font-medium text-gray-900">üìä Global Activity (7 days)</h3>
                </div>
                <div class="relative">
                  <canvas id="globalActivityChart" height="90"></canvas>
                </div>
              </div>
              
              <!-- Recent Activity -->
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="modern-card p-6">
                  <h3 class="text-lg font-medium text-gray-900 mb-4">üìà Recent Organizations</h3>
                  <div id="recentOrganizations" class="space-y-3">
                    <!-- Recent orgs will load here -->
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <h3 class="text-lg font-medium text-gray-900 mb-4">üö® System Alerts</h3>
                  <div id="systemAlerts" class="space-y-3">
                    <!-- System alerts will load here -->
                  </div>
                </div>
              </div>
            </div>

            <!-- Organizations Tab -->
            <div id="organizationsMasterContent" class="tab-content hidden">
              <div class="mb-6 flex justify-between items-center">
                <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">üè¢ Organizations</h1>
                <button id="addOrganizationBtn" class="btn-primary-modern">‚ú® Add New Organization</button>
              </div>

            <!-- Organizations List -->
            <div class="modern-card overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                  <div class="flex items-center justify-between">
                    <h3 class="text-lg font-medium text-gray-900">All Organizations</h3>
                    <div class="flex items-center space-x-2">
                      <input type="text" id="organizationSearch" placeholder="Search organizations..." 
                             class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                      <select id="organizationFilter" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">All Plans</option>
                        <option value="basic">Basic</option>
                        <option value="premium">Premium</option>
                        <option value="enterprise">Enterprise</option>
                      </select>
                    </div>
                  </div>
                </div>
                
                <div class="overflow-x-auto">
                  <table class="min-w-full divide-y divide-gray-200 admin-table">
                    <thead>
                      <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Organization</th>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Subdomain</th>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Plan</th>
                      <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Verses</th>
                      <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Admins</th>
                      <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Users</th>
                      <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Last Activity</th>
                      <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Views (7d)</th>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Status</th>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Created</th>
                        <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="organizationsTable" class="bg-white divide-y divide-gray-200">
                      <!-- Organizations will be loaded here -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Organization Requests Tab -->
            <div id="orgRequestsMasterContent" class="tab-content hidden">
              <div class="mb-6 flex justify-between items-center">
                <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">üìã Organization Requests</h1>
                <div class="flex items-center space-x-4">
                  <select id="requestsStatusFilter" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">All Statuses</option>
                    <option value="pending">Pending</option>
                    <option value="approved">Approved</option>
                    <option value="rejected">Rejected</option>
                  </select>
                </div>
              </div>

              <!-- Organization Requests Table -->
              <div class="modern-card overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                  <h3 class="text-lg font-medium text-gray-900">üìã Organization Requests</h3>
                </div>

                <div class="overflow-x-auto">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Organization</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact Info</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Plan</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Submitted</th>
                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="orgRequestsTableBody" class="bg-white divide-y divide-gray-200">
                      <!-- Organization requests will be loaded here -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div id="billingMasterContent" class="tab-content hidden">
              <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-8">üí≥ Billing & Plans</h1>
              <div class="modern-card p-6">
                <p class="text-gray-600">Billing management coming soon...</p>
              </div>
            </div>

            <div id="analyticsMasterContent" class="tab-content hidden">
              <div class="mb-6 flex justify-between items-center">
                <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">üìà Global Analytics</h1>
                <div class="flex items-center space-x-4">
                  <select id="analyticsTimeframe" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="24h">Last 24 Hours</option>
                    <option value="7d" selected>Last 7 Days</option>
                    <option value="30d">Last 30 Days</option>
                    <option value="90d">Last 90 Days</option>
                  </select>
                  <select id="analyticsOrganization" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">All Organizations</option>
                  </select>
                </div>
              </div>

              <!-- Analytics Cards -->
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üì±</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Total Scans</dt>
                        <dd id="totalScans" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üè∑Ô∏è</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Unique Tags</dt>
                        <dd id="uniqueTags" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üë•</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Active Sessions</dt>
                        <dd id="activeSessions" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üåç</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Countries</dt>
                        <dd id="uniqueCountries" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
              </div>

              <!-- World Map -->
              <div class="modern-card p-6 mb-8">
                <h3 class="text-lg font-medium text-gray-900 mb-6">üó∫Ô∏è User Location Map</h3>
                <div class="relative">
                  <div id="worldMap" style="height: 400px; background: #f8fafc; border-radius: 8px; position: relative;">
                    <div class="absolute inset-0 flex items-center justify-center">
                      <div class="text-center">
                        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"></div>
                        <p class="text-gray-600">Loading map data...</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Sessions List -->
              <div class="modern-card overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                  <h3 class="text-lg font-medium text-gray-900">üéØ Recent User Sessions</h3>
                </div>
                
                <div class="overflow-x-auto">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Session</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tags Scanned</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Activities</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="sessionsTable" class="bg-white divide-y divide-gray-200">
                      <!-- Sessions will be loaded here -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Tag Activities Tab -->
            <div id="tagActivitiesMasterContent" class="tab-content hidden">
              <div class="mb-6 flex justify-between items-center">
                <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">üéØ Tag Activities</h1>
                <div class="flex items-center space-x-4">
                  <select id="tagActivitiesTimeframe" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="24h">Last 24 Hours</option>
                    <option value="7d" selected>Last 7 Days</option>
                    <option value="30d">Last 30 Days</option>
                    <option value="90d">Last 90 Days</option>
                  </select>
                  <select id="tagActivitiesOrganization" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">All Organizations</option>
                  </select>
                  <select id="tagActivitiesTag" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">All Tags</option>
                  </select>
                </div>
              </div>

              <!-- Tag Activities Summary -->
              <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üìä</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Total Activities</dt>
                        <dd id="totalScansCount" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üè∑Ô∏è</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Active Tags</dt>
                        <dd id="uniqueTagsCount" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üë•</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Active Sessions</dt>
                        <dd id="activeSessionsCount" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
                
                <div class="modern-card p-6">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <div class="w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center">
                        <span class="text-white text-lg">üéØ</span>
                      </div>
                    </div>
                    <div class="ml-5 w-0 flex-1">
                      <dl>
                        <dt class="text-sm font-medium text-gray-500 truncate">Followup Activities</dt>
                        <dd id="followupActivitiesCount" class="text-2xl font-bold text-gray-900">--</dd>
                      </dl>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Tag Activities Table -->
              <div class="modern-card overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                  <h3 class="text-lg font-medium text-gray-900">üìã Detailed Tag Activities</h3>
                  <div class="text-sm text-gray-500">
                    Total: <span id="tagActivitiesTotal">--</span> activities
                  </div>
                </div>
                
                <!-- Loading state -->
                <div id="tagActivitiesLoading" class="hidden p-8 text-center">
                  <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"></div>
                  <p class="text-gray-600">Loading tag activities...</p>
                </div>

                <!-- Empty state -->
                <div id="tagActivitiesEmpty" class="hidden p-8 text-center">
                  <p class="text-gray-600">No tag activities found for the selected criteria.</p>
                </div>

                <!-- Table container -->
                <div id="tagActivitiesTableContainer" class="overflow-x-auto">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tag ID</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Session</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Organization</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Activities</th>
                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="tagActivitiesTable" class="bg-white divide-y divide-gray-200">
                      <!-- Tag activities will be loaded here -->
                    </tbody>
                  </table>
                </div>
                </div>

                <!-- Pagination -->
                <div class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6">
                  <div class="flex-1 flex justify-between sm:hidden">
                    <button id="tagActivitiesPrevBtn" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                      Previous
                    </button>
                    <button id="tagActivitiesNextBtn" class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                      Next
                    </button>
                  </div>
                  <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                    <div>
                      <p class="text-sm text-gray-700">
                        Showing <span id="tagActivitiesShowingStart">1</span> to <span id="tagActivitiesShowingEnd">25</span> of <span id="tagActivitiesShowingTotal">--</span> results
                      </p>
                    </div>
                    <div>
                      <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" id="tagActivitiesPagination">
                        <!-- Pagination buttons will be added here -->
                      </nav>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div id="supportMasterContent" class="tab-content hidden">
              <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-8">üéß Support</h1>
              <div class="modern-card p-6">
                <p class="text-gray-600">Support management coming soon...</p>
              </div>
            </div>

            <div id="systemMasterContent" class="tab-content hidden">
              <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-8">‚öôÔ∏è System Settings</h1>
              <div class="modern-card p-6">
                <p class="text-gray-600">System settings coming soon...</p>
              </div>
            </div>

          </div>
        </main>
      </div>
    </div>
  </div>

  <!-- Add Organization Modal -->
  <div id="organizationModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-xl bg-white">
      <div class="mt-3">
        <h3 id="organizationModalTitle" class="text-lg font-medium text-gray-900 mb-4">‚ú® Add New Organization</h3>
        
        <form id="organizationForm" class="space-y-4">
          <input type="hidden" id="organizationId">
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="organizationName" class="block text-sm font-medium text-gray-700">Organization Name</label>
              <input type="text" id="organizationName" required 
                     class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                     placeholder="e.g., First Baptist Church">
            </div>
            
            <div>
              <label for="organizationSubdomain" class="block text-sm font-medium text-gray-700">Subdomain</label>
              <input type="text" id="organizationSubdomain" required 
                     class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                     placeholder="e.g., firstbaptist">
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="organizationEmail" class="block text-sm font-medium text-gray-700">Contact Email</label>
              <input type="email" id="organizationEmail" 
                     class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                     placeholder="pastor@church.org">
            </div>
            
            <div>
              <label for="organizationPlan" class="block text-sm font-medium text-gray-700">Plan</label>
              <select id="organizationPlan" required 
                      class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                <option value="basic">Basic - $29/month</option>
                <option value="premium">Premium - $79/month</option>
                <option value="enterprise">Enterprise - $199/month</option>
              </select>
            </div>
          </div>

          <div>
            <label for="organizationCustomDomain" class="block text-sm font-medium text-gray-700">Custom Domain (Optional)</label>
            <input type="text" id="organizationCustomDomain"
                   class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                   placeholder="verses.yourchurch.org">
          </div>

          <!-- Organization Details Section -->
          <div class="border-t pt-6">
            <h4 class="text-md font-medium text-gray-900 mb-4">Organization Details</h4>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="organizationType" class="block text-sm font-medium text-gray-700">Organization Type</label>
                <select id="organizationType"
                        class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                  <option value="">Select Type</option>
                  <option value="church">Church</option>
                  <option value="ministry">Ministry</option>
                  <option value="nonprofit">Non-Profit</option>
                  <option value="business">Business</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <div>
                <label for="organizationJoinType" class="block text-sm font-medium text-gray-700">Join Type</label>
                <select id="organizationJoinType"
                        class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                  <option value="open">Open (Anyone can join)</option>
                  <option value="approval">Approval Required</option>
                  <option value="invite">Invite Only</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Address Section -->
          <div class="border-t pt-6">
            <h4 class="text-md font-medium text-gray-900 mb-4">Address Information</h4>

            <div>
              <label for="organizationAddress" class="block text-sm font-medium text-gray-700">Street Address</label>
              <input type="text" id="organizationAddress"
                     class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                     placeholder="123 Main Street">
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
              <div>
                <label for="organizationCity" class="block text-sm font-medium text-gray-700">City</label>
                <input type="text" id="organizationCity"
                       class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                       placeholder="Dallas">
              </div>

              <div>
                <label for="organizationState" class="block text-sm font-medium text-gray-700">State/Province</label>
                <input type="text" id="organizationState"
                       class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                       placeholder="TX">
              </div>

              <div>
                <label for="organizationZipCode" class="block text-sm font-medium text-gray-700">ZIP/Postal Code</label>
                <input type="text" id="organizationZipCode"
                       class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                       placeholder="75201">
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
              <div>
                <label for="organizationCountry" class="block text-sm font-medium text-gray-700">Country</label>
                <select id="organizationCountry"
                        class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                  <option value="US">United States</option>
                  <option value="CA">Canada</option>
                  <option value="GB">United Kingdom</option>
                  <option value="AU">Australia</option>
                  <option value="DE">Germany</option>
                  <option value="FR">France</option>
                  <option value="IT">Italy</option>
                  <option value="ES">Spain</option>
                  <option value="BR">Brazil</option>
                  <option value="MX">Mexico</option>
                  <option value="OTHER">Other</option>
                </select>
              </div>

              <div>
                <label for="organizationLatitude" class="block text-sm font-medium text-gray-700">Latitude (Optional)</label>
                <input type="number" id="organizationLatitude" step="any"
                       class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                       placeholder="32.7767">
              </div>

              <div>
                <label for="organizationLongitude" class="block text-sm font-medium text-gray-700">Longitude (Optional)</label>
                <input type="number" id="organizationLongitude" step="any"
                       class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
                       placeholder="-96.7970">
              </div>
            </div>
          </div>

          <div class="flex justify-end space-x-3 pt-4">
            <button type="button" id="cancelOrganizationModal" class="btn-secondary-modern">Cancel</button>
            <button type="submit" class="btn-primary-modern">Create Organization</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="/js/master.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Leaflet Map Library -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</body>
</html>